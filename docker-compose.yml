version: "1.3"
services:
    rabbitmq:
        container_name: ed_rabbit
        image: rabbitmq:3.11.13-management
        environment:
            TZ: UTC
            RABBITMQ_DEFAULT_USER: ${RABBITMQ_DEFAULT_USER}
            RABBITMQ_DEFAULT_PASS: ${RABBITMQ_DEFAULT_PASS}
            RABBITMQ_CONFIG_FILE: /etc/rabbitmq/rabbitmq.conf
        volumes:
            - rabbitedvol:/var/lib/rabbitmq
            - ${RABBITMQ_CONFIG_FILE}:/etc/rabbitmq/rabbitmq.conf
            - ${RABBITMQ_SSL_CACERTFILE}:/etc/rabbitmq/ca_certificate.pem
            - ${RABBITMQ_SSL_CERTFILE}:/etc/rabbitmq/server_certificate.pem
            - ${RABBITMQ_SSL_KEYFILE}:/etc/rabbitmq/server_key.pem
        ports:
            - "5671:5671"
            - "15671:15671"
        restart: always
    redis:
        container_name: ed_redis_server
        image: redis:6.2.12
        environment:
            TZ: UTC
        volumes:
            - redisvol:/data
        ports:
            - "6379:6379"
        restart: always
    mysql:
        container_name: ed_database
        image: mysql:8
        environment:
            TZ: UTC
            MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
            MYSQL_HOME: /etc/mysql/my.cnf
        volumes:
            - ed_database:/var/lib/mysql
            - ${MYSQL_CONFIG_FILE}:/etc/mysql/my.cnf
        ports:
            - "3306:3306"
        restart: always

volumes:
    rabbitedvol:
    ed_database:
    redisvol: